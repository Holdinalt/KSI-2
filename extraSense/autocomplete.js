const dragonsData = {
    "Горный":{
        "img": "Mountain.webp"
    },
    "Морской":{
        "img": "Ocean.webp"
    },
    "Облачный":{
        "img": "Cloud.webp"
    },
    "Огненный":{
        "img": "Infernal.webp"
    },
    "Хекстековый":{
        "img": "Hextech.webp"
    },
    "Химтековый":{
        "img": "Chemtech.webp"
    }
}

const playersData = {
    "fasoollka":{
        "img": "fasoollka.jpg"
    },
    "zanzarahlol":{
        "img": "Zanzarah.jpg"
    },
    "boss":{
        "img": "Boss.png"
    },
    "Oktomar":{
        "img": "Oktomar.jpg"
    },
    "HappyZerG":{
        "img": "HappyZerG.jpg"
    },
    "Tijoe":{
        "img": "tijoe.gif"
    },
    "kenal_lol":{
        "img": "Kenal.png"
    },
    "b1ackorchid":{
        "img": "B1ackOrchid.jpg"
    },
    "turntheslayer":{
        "img": "slayer.jpg"
    },
    "Sh4dowfi4sh":{
        "img": "Sh4dowfi4sh.jpg"
    },
    "General_HS":{
        "img": "General_HS.jpg"
    },
    "ahahacikkk":{
        "img": "AHAHACIK.jpg"
    },
    "k1tava_":{
        "img": "unknown-player.png"
    },
    "castleinthesky_":{
        "img": "castleinthesky.jpg"
    },
    "chidoryan":{
        "img": "Chidoryan.jpg"
    },
    "Unho1y":{
        "img": "unho1y.jpg"
    },
    "anechek":{
        "img": "Anechek.webp"
    },
    "Santas":{
        "img": "Santas.png"
    },
    "PowerOfLawyer":{
        "img": "Poweroflaweyr.jpg"
    },
    "BrO_k3N123":{
        "img": "unknown-player.png"
    },
    "Teamless":{
        "img": "teamless.jpg"
    },
    "kreoxlol":{
        "img": "Kreox.png"
    },
    "podushhka":{
        "img": "Podushka.jpg"
    },
    "creator415":{
        "img": "Creator415.jpg"
    },
    "BestNorik":{
        "img": "BestNorik.jpg"
    },
    "Smurf":{
        "img": "Smurf.png"
    },
    "mightydragon":{
        "img": "XmightyDragon.jpg"
    },
    "starkycast":{
        "img": "Starky.png"
    },
    "Speakeriter":{
        "img": "unknown-player.png"
    },
    "Skorpak":{
        "img": "Skorpak.jpg"
    },
    "Likkrit":{
        "img": "Likkrit.jpg"
    },
    "demonadcL9":{
        "img": "demonadc.jpg"
    },
    "darienlol":{
        "img": "Darien.jpg"
    },
    "fedeki_":{
        "img": "fedeki.jpg"
    },
    "Genes1s":{
        "img": "Genes1s.jpg"
    },
    "Diamondprox":{
        "img": "Diamondprox.webp"
    },
    "lolPatience":{
        "img": "Lolpatience.jpg"
    },
    "ShtutikV2":{
        "img": "SHTUTIKV2.jpg"
    },
    "fomko47":{
        "img": "Fomko.jpg"
    },
    "exlfx_":{
        "img": "unknown-player.png"
    },
    "Dimill":{
        "img": "dimill.jpg"
    },
    "Kirrrrra":{
        "img": "Kira.jpg"
    },
    "medved_ede":{
        "img": "Medved_ede.jpg"
    },
    "sankaizer":{
        "img": "Sankaizer.jpg"
    },
    "HowToPlayAD":{
        "img": "HowToPlayAD.jpg"
    },
    "Nomanz":{
        "img": "Nomanz.jpg"
    },
    "Gadget":{
        "img": "Gadget.webp"
    },
    "y_a_g_a_m_1_":{
        "img": "Yagami.jpg"
    },
    "nekochan228":{
        "img": "unknown-player.png"
    },
    "dadhorse_":{
        "img": "unknown-player.png"
    }
}

const teamsData = {
    "Аккаунты Генерала":{
        "img": "general.svg"
    },
    "Аферисты Тимлесса":{
        "img": "teamless.svg"
    },
    "Вайфочки Даймонда":{
        "img": "dimond.svg"
    },
    "Волосы Димилла":{
        "img": "dimill.svg"
    },
    "Гномы Фасольки":{
        "img": "fasolka.svg"
    },
    "Дубины Смурфа":{
        "img": "smurf.svg"
    },
    "Единороги Номанза":{
        "img": "nomanz.svg"
    },
    "Пропущенные телеги Анхоли":{
        "img": "unholy.svg"
    },
    "Рыгалики Тиджоя":{
        "img": "tijoy.svg"
    },
    "Лазаньи Ликкрита":{
        "img": "likrit.svg"
    },
}

const champPicData = {
    "Азир": {
        "img": "1.jpg"
    },
    "Акали": {
        "img": "2.jpg"
    },
    "Акшан": {
        "img": "3.jpg"
    },
    "Алистар": {
        "img": "4.jpg"
    },
    "Амуму": {
        "img": "5.jpg"
    },
    "Анивия": {
        "img": "6.jpg"
    },
    "Ари": {
        "img": "7.jpg"
    },
    "Атрокс": {
        "img": "8.jpg"
    },
    "Аурелион Сол": {
        "img": "9.jpg"
    },
    "Афелий": {
        "img": "10.jpg"
    },
    "Бард": {
        "img": "11.jpg"
    },
    "Бел'Вет": {
        "img": "12.jpg"
    },
    "Блицкранк": {
        "img": "13.jpg"
    },
    "Браум": {
        "img": "14.jpg"
    },
    "Брэнд": {
        "img": "15.jpg"
    },
    "Вай": {
        "img": "16.jpg"
    },
    "Варус": {
        "img": "17.jpg"
    },
    "Вейгар": {
        "img": "18.jpg"
    },
    "Вейн": {
        "img": "19.jpg"
    },
    "Векс": {
        "img": "20.jpg"
    },
    "Вел'Коз": {
        "img": "21.jpg"
    },
    "Виего": {
        "img": "22.jpg"
    },
    "Виктор": {
        "img": "23.jpg"
    },
    "Владимир": {
        "img": "24.jpg"
    },
    "Волибир": {
        "img": "25.jpg"
    },
    "Вуконг": {
        "img": "26.jpg"
    },
    "Галио": {
        "img": "27.jpg"
    },
    "Гангпланк": {
        "img": "28.jpg"
    },
    "Гарен": {
        "img": "29.jpg"
    },
    "Гвен": {
        "img": "30.jpg"
    },
    "Гекарим": {
        "img": "31.jpg"
    },
    "Гнар": {
        "img": "32.jpg"
    },
    "Грагас": {
        "img": "33.jpg"
    },
    "Грейвз": {
        "img": "34.jpg"
    },
    "Дариус": {
        "img": "35.jpg"
    },
    "Джакс": {
        "img": "36.jpg"
    },
    "Джарван IV": {
        "img": "37.jpg"
    },
    "Джейс": {
        "img": "38.jpg"
    },
    "Джин": {
        "img": "39.jpg"
    },
    "Джинкс": {
        "img": "40.jpg"
    },
    "Диана": {
        "img": "41.jpg"
    },
    "Доктор Мундо": {
        "img": "42.jpg"
    },
    "Дрейвен": {
        "img": "43.jpg"
    },
    "Ёнэ": {
        "img": "44.jpg"
    },
    "Жанна": {
        "img": "45.jpg"
    },
    "Зайра": {
        "img": "46.jpg"
    },
    "Зак": {
        "img": "47.jpg"
    },
    "Зед": {
        "img": "48.jpg"
    },
    "Зерат": {
        "img": "49.jpg"
    },
    "Зери": {
        "img": "50.jpg"
    },
    "Зиггс": {
        "img": "51.jpg"
    },
    "Зилеан": {
        "img": "52.jpg"
    },
    "Зои": {
        "img": "53.jpg"
    },
    "Иверн": {
        "img": "54.jpg"
    },
    "Иллаой": {
        "img": "55.jpg"
    },
    "Ирелия": {
        "img": "56.jpg"
    },
    "Йорик": {
        "img": "57.jpg"
    },
    "К'Санте": {
        "img": "58.jpg"
    },
    "Ка'Зикс": {
        "img": "59.jpg"
    },
    "Каин": {
        "img": "60.jpg"
    },
    "Кай'Са": {
        "img": "61.jpg"
    },
    "Калиста": {
        "img": "62.jpg"
    },
    "Камилла": {
        "img": "63.jpg"
    },
    "Карма": {
        "img": "64.jpg"
    },
    "Картус": {
        "img": "65.jpg"
    },
    "Кассадин": {
        "img": "66.jpg"
    },
    "Кассиопея": {
        "img": "67.jpg"
    },
    "Катарина": {
        "img": "68.jpg"
    },
    "Квинн": {
        "img": "69.jpg"
    },
    "Кейл": {
        "img": "70.jpg"
    },
    "Кейтлин": {
        "img": "71.jpg"
    },
    "Кеннен": {
        "img": "72.jpg"
    },
    "Киана": {
        "img": "73.jpg"
    },
    "Киндред": {
        "img": "74.jpg"
    },
    "Клед": {
        "img": "75.jpg"
    },
    "Ког'Мао": {
        "img": "76.jpg"
    },
    "Корки": {
        "img": "77.jpg"
    },
    "Ксин Жао": {
        "img": "78.jpg"
    },
    "Ле Блан": {
        "img": "79.jpg"
    },
    "Леона": {
        "img": "80.jpg"
    },
    "Ли Син": {
        "img": "81.jpg"
    },
    "Лиллия": {
        "img": "82.jpg"
    },
    "Лиссандра": {
        "img": "83.jpg"
    },
    "Лулу": {
        "img": "84.jpg"
    },
    "Люкс": {
        "img": "85.jpg"
    },
    "Люциан": {
        "img": "86.jpg"
    },
    "Мальзахар": {
        "img": "87.jpg"
    },
    "Мальфит": {
        "img": "88.jpg"
    },
    "Маокай": {
        "img": "89.jpg"
    },
    "Мастер Йи": {
        "img": "90.jpg"
    },
    "Милио": {
        "img": "91.jpg"
    },
    "Мисс Фортуна": {
        "img": "92.jpg"
    },
    "Моргана": {
        "img": "93.jpg"
    },
    "Мордекайзер": {
        "img": "94.jpg"
    },
    "Нами": {
        "img": "95.jpg"
    },
    "Насус": {
        "img": "96.jpg"
    },
    "Наутилус": {
        "img": "97.jpg"
    },
    "Нидали": {
        "img": "98.jpg"
    },
    "Нико": {
        "img": "99.jpg"
    },
    "Нила": {
        "img": "100.jpg"
    },
    "Ноктюрн": {
        "img": "101.jpg"
    },
    "Нуну и Виллумп": {
        "img": "102.jpg"
    },
    "Олаф": {
        "img": "103.jpg"
    },
    "Орианна": {
        "img": "104.jpg"
    },
    "Орн": {
        "img": "105.jpg"
    },
    "Пайк": {
        "img": "106.jpg"
    },
    "Пантеон": {
        "img": "107.jpg"
    },
    "Поппи": {
        "img": "108.jpg"
    },
    "Райз": {
        "img": "109.jpg"
    },
    "Рамбл": {
        "img": "110.jpg"
    },
    "Раммус": {
        "img": "111.jpg"
    },
    "Рек'Сай": {
        "img": "112.jpg"
    },
    "Релл": {
        "img": "113.jpg"
    },
    "Рената Гласк": {
        "img": "114.jpg"
    },
    "Ренгар": {
        "img": "115.jpg"
    },
    "Ренектон": {
        "img": "116.jpg"
    },
    "Ривен": {
        "img": "117.jpg"
    },
    "Рэйкан": {
        "img": "118.jpg"
    },
    "Сайлас": {
        "img": "119.jpg"
    },
    "Самира": {
        "img": "120.jpg"
    },
    "Свейн": {
        "img": "121.jpg"
    },
    "Седжуани": {
        "img": "122.jpg"
    },
    "Сенна": {
        "img": "123.jpg"
    },
    "Серафина": {
        "img": "124.jpg"
    },
    "Сетт": {
        "img": "125.jpg"
    },
    "Сивир": {
        "img": "126.jpg"
    },
    "Синджед": {
        "img": "127.jpg"
    },
    "Синдра": {
        "img": "128.jpg"
    },
    "Сион": {
        "img": "129.jpg"
    },
    "Скарнер": {
        "img": "130.jpg"
    },
    "Сона": {
        "img": "131.jpg"
    },
    "Сорака": {
        "img": "132.jpg"
    },
    "Таам Кенч": {
        "img": "133.jpg"
    },
    "Талия": {
        "img": "134.jpg"
    },
    "Талон": {
        "img": "135.jpg"
    },
    "Тарик": {
        "img": "136.jpg"
    },
    "Твистед Фэйт": {
        "img": "137.jpg"
    },
    "Твич": {
        "img": "138.jpg"
    },
    "Тимо": {
        "img": "139.jpg"
    },
    "Трандл": {
        "img": "140.jpg"
    },
    "Треш": {
        "img": "141.jpg"
    },
    "Триндамир": {
        "img": "142.jpg"
    },
    "Тристана": {
        "img": "143.jpg"
    },
    "Удир": {
        "img": "144.jpg"
    },
    "Ургот": {
        "img": "145.png"
    },
    "Фиддлстикс": {
        "img": "146.jpg"
    },
    "Физз": {
        "img": "147.jpg"
    },
    "Фиора": {
        "img": "148.jpg"
    },
    "Хеймердингер": {
        "img": "149.jpg"
    },
    "Чо'Гат": {
        "img": "150.jpg"
    },
    "Шако": {
        "img": "151.jpg"
    },
    "Шая": {
        "img": "152.jpg"
    },
    "Шен": {
        "img": "153.jpg"
    },
    "Шивана": {
        "img": "154.jpg"
    },
    "Эвелинн": {
        "img": "155.jpg"
    },
    "Эзреаль": {
        "img": "156.jpg"
    },
    "Экко": {
        "img": "157.jpg"
    },
    "Элиза": {
        "img": "158.jpg"
    },
    "Энни": {
        "img": "159.jpg"
    },
    "Эш": {
        "img": "160.jpg"
    },
    "Юми": {
        "img": "161.jpg"
    },
    "Ясуо": {
        "img": "162.jpg"
    },
    "Варвик": {
        "img": "163.jpg"
    }
}

const setIsCompleted = (bool) => {

    const checkNode = document.getElementsByClassName('choice-header-check-mark-check')[0]
    const crossNode = document.getElementsByClassName('choice-header-check-mark-cross')[0]

    if(bool){
        crossNode.classList.add('hidden')
        checkNode.classList.remove('hidden')
    }else{
        checkNode.classList.add('hidden')
        crossNode.classList.remove('hidden')
    }
}

const setChampPictureToCard = (input, champion) => {

    const pic = input.parentNode.parentNode.children[0].children[0];

    pic.setAttribute('style', `background-image: url(\'../assets/champions/${champPicData[champion]['img']}\');
             background-size: 165px; background-position: top;width: 165px; height: 115px;`)
}

const addChampionAutocomplete = (questionNumber) => {

    const champions = new autoComplete({
        selector: `#question${questionNumber}`,
        data: {
            src: Object.keys(champPicData),
            cache: true,
        },
        events: {
            input: {
                selection: (event) => {
                    champions.input.value = event.detail.selection.value;
                }
            }
        },
        resultItem: {
            class: "card-controls-input-resultItem"
        },
        resultsList: {
            maxResults: 3,
            class: "card-controls-input-resultsList"
        },
        wrapper: false,
    });

    document.querySelector(`#question${questionNumber}`).addEventListener("selection", function (event) {
        setChampPictureToCard(event.target, event.detail.selection.value)
        champPickEvent(questionNumber, event.detail.selection.value)
    });
}

const champPickEvent = (questionNum, champion) => {
    // Logic
}

const champQuestionList = [1, 2, 3, 4, 5]

for (const questNum of champQuestionList){
    addChampionAutocomplete(questNum)
}

const numberPickEvent = (questionNumber, number) => {
}

const numberQuestionList = [11]

let oldInputRatiosMap = new Map();

for (const questionNumber of numberQuestionList){

    const node = document.querySelector(`#question${questionNumber}`);



    node.setAttribute('type', 'number')
    node.addEventListener("input", function (event) {

        if(event.data !== '-' && event.data !== '.' && event.data !== ',' && event.data !== '+'){
            oldInputRatiosMap.set(event, event.target.value)

            setTextPictureToCard(event.target, event.target.value)
            numberPickEvent(questionNumber, event.target.value)
        }else{
            event.target.value = oldInputRatio
        }
    });
}

const setTextPictureToCard = (input, text) => {

    const pic = input.parentNode.parentNode.children[0].children[0];

    if (text !== ''){
        if(pic.children[0]){
            pic.children[0].textContent = text;
        }else{
            const span = document.createElement('span');
            span.textContent = text
            span.setAttribute('class', 'card-describe-picture-text')

            pic.setAttribute('style', 'background: 0')
            pic.appendChild(span)
        }

    }else{
        pic.children[0].remove()
        pic.removeAttribute('style')
    }
}

const addTeamsAutocomplete = (questionNumber) => {

    const teams = new autoComplete({
        selector: `#question${questionNumber}`,
        data: {
            src: Object.keys(teamsData), //TODO
            cache: true,
        },
        events: {
            input: {
                selection: (event) => {
                    teams.input.value = event.detail.selection.value;
                }
            }
        },
        resultItem: {
            class: "card-controls-input-resultItem"
        },
        resultsList: {
            maxResults: 3,
            class: "card-controls-input-resultsList"
        },
        wrapper: false,
    });

    document.querySelector(`#question${questionNumber}`).addEventListener("selection", function (event) {
        setTeamLogoToCard(event.target, event.detail.selection.value)
        teamPickEvent(questionNumber, event.detail.selection.value)
    });

}

const setTeamLogoToCard = (input, team) => {
    const pic = input.parentNode.parentNode.children[0].children[0];

    pic.setAttribute('style', `background-image: url(\'../assets/teamLogos/${teamsData[team]['img']}\');
             background-size: 115px; background-position: center;width: 165px; height: 115px; background-repeat: no-repeat;`)
}


const teamPickEvent = (questionNum, team) => {
    // Logic
}

const teamsQuestionList = [12, 16]

for (const questionNumber of teamsQuestionList){
    addTeamsAutocomplete(questionNumber)
}

const dragonsQuestionList = [15]

const addDragonsAutocomplete = (questionNumber) => {

    const teams = new autoComplete({
        selector: `#question${questionNumber}`,
        data: {
            src: Object.keys(dragonsData), //TODO
            cache: true,
        },
        events: {
            input: {
                selection: (event) => {
                    teams.input.value = event.detail.selection.value;
                }
            }
        },
        resultItem: {
            class: "card-controls-input-resultItem"
        },
        resultsList: {
            maxResults: 3,
            class: "card-controls-input-resultsList"
        },
        wrapper: false,
    });

    document.querySelector(`#question${questionNumber}`).addEventListener("selection", function (event) {
        // setTeamLogoToCard(event.target, event.detail.selection.value)
        // teamPickEvent(questionNumber, event.detail.selection.value)

        setDragonLogoToCard(event.target, event.detail.selection.value)
        dragonPickEvent(questionNumber, event.detail.selection.value)
    });

}

const setDragonLogoToCard = (input, dragon) => {
    const pic = input.parentNode.parentNode.children[0].children[0];

    pic.setAttribute('style', `background-image: url(\'../assets/dragons/${dragonsData[dragon]['img']}\');
             background-size: 115px; background-position: center;width: 165px; height: 115px; background-repeat: no-repeat;`)
}

const dragonPickEvent = (questionNum, dragon) =>
{
    SaveQuestionAnswer(questionNum, dragon, 'dragon');
}

for (const questionNumber of dragonsQuestionList){
    addDragonsAutocomplete(questionNumber)
}



const playersQuestionList = [6, 7, 8, 9, 10]

const addPlayersAutocomplete = (questionNumber) => {

    const players = new autoComplete({
        selector: `#question${questionNumber}`,
        data: {
            src: Object.keys(playersData),
            cache: true,
        },
        events: {
            input: {
                selection: (event) => {
                    players.input.value = event.detail.selection.value;
                }
            }
        },
        resultItem: {
            class: "card-controls-input-resultItem"
        },
        resultsList: {
            maxResults: 3,
            class: "card-controls-input-resultsList"
        },
        wrapper: false,
    });

    document.querySelector(`#question${questionNumber}`).addEventListener("selection", function (event) {
        setPlayersLogoToCard(event.target, event.detail.selection.value)
        playersPickEvent(questionNumber, event.detail.selection.value)
    });

}

const setPlayersLogoToCard = (input, player) => {
    const pic = input.parentNode.parentNode.children[0].children[0];

    pic.setAttribute('style', `background-image: url(\'../assets/players/${playersData[player]['img']}\');
             background-size: 165px; background-position: center;width: 165px; height: 115px; background-repeat: no-repeat;`)
}

const playersPickEvent = (questionNum, player) => {
    // Logic
}

for (const questionNumber of playersQuestionList){
    addPlayersAutocomplete(questionNumber)
}

const addRatioControl = (questionNumber) => {

    const ratios = document.querySelector(`#question${questionNumber}`).children
    let pickedRatio;

    for(let i = 0; i < ratios.length; i++){
        const ratio = ratios[i]
        ratio.addEventListener("click", function (event) {

            if(pickedRatio){
                ratioUnPickStyle(pickedRatio)
            }
            ratioPickStyle(ratio)
            pickedRatio = ratio;

            setTextPictureToCard(ratio.parentNode, ratio.children[0].textContent)

            ratioPickEvent(questionNumber, i, ratio.children[0].textContent)

            // setPlayersLogoToCard(event.target, event.detail.selection.value)
            // playersPickEvent(questionNumber, event.detail.selection.value)
        });
    }

}

const ratioPickStyle = (ratio) => {
    ratio.setAttribute('style', 'background: #D4B26F; border: none')
    ratio.children[0].setAttribute('style', 'color: black')
}

const ratioUnPickStyle = (ratio) => {
    ratio.removeAttribute('style')
    ratio.children[0].removeAttribute('style')
}

const ratioPickEvent = (questionNum, ratioNumber, ratioText) => {
    //Logic
}

const ratioList = [13, 14]

for (const rat of ratioList){
    addRatioControl(rat)
}


// result = true или 1 - green, false или 0 - red
const setPredictionResult = (input, result) => {
    const card = input.parentNode.parentNode;

    const GREEN = '#0AA73F'
    const RED = '#CC252F'

    let color;

    if(result){
        color = GREEN
    }else {
        color = RED
    }

    for(let node of input.parentNode.children){
        node.setAttribute('style', `border-color: ${color};`)
    }

    card.setAttribute('style', `border-color: ${color};`)
}


const pickTeam = (event) => {
//Logic
}

const styleTeamLogos = (winTeamLogo, loseTeamLogo) => {
    winTeamLogo.classList.remove('lose')
    loseTeamLogo.classList.add('lose')
}

const setTeamPick = (gameID, pickedTeamID) =>
{
    const game = document.querySelector(`#game${gameID}`)
    const teams = Array.from(game.children[1].children).filter((item) => item.id)

    let winTeam;
    let loseTeam;

    winTeam = teams.find((team) => team.id === `team${pickedTeamID}`)
    loseTeam = teams.find((team) => team !== winTeam)

    styleTeamLogos(winTeam.children[0].children[0], loseTeam.children[0].children[0]);
}

const setPickResult = (gameID, result) =>
{
    const game = document.querySelector(`#game${gameID}`)

    const resultNode = document.createElement('div')
    game.append(resultNode)

    if(result)
    {
        resultNode.setAttribute('style',
            `position: absolute; width: 33px; height: 33px; background-image: url("../assets/checkGroups.svg"); margin-left: ${-50}px`
        )
    }
    else
    {
        resultNode.setAttribute('style',
            `position: absolute; width: 33px; height: 33px; background-image: url("../assets/crossGroups.svg"); margin-left: ${-50}px`
        )
    }
}


const teamPicked = (gameID, pickedTeam) =>
{
    SavePlayoffPickem(gameID, pickedTeam);
}